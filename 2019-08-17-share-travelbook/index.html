<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>旅行小账本 | 云开发-一站式后端云服务</title>
    <meta name="description" content="云+端一体化：快速构建小程序、Web和移动应用">
    <script type="text/javascript" src="/scripts/baidu-analytics.js" async=""></script>
  <link rel="icon" href="/favicon.png">
    
    <link rel="preload" href="/assets/css/0.styles.35fe7a73.css" as="style"><link rel="preload" href="/assets/js/app.c43e3f1e.js" as="script"><link rel="preload" href="/assets/js/2.593b11d3.js" as="script"><link rel="preload" href="/assets/js/200.39293e0a.js" as="script"><link rel="preload" href="/assets/js/5.74e570c4.js" as="script"><link rel="prefetch" href="/assets/js/10.5e44b41a.js"><link rel="prefetch" href="/assets/js/100.2747df66.js"><link rel="prefetch" href="/assets/js/101.c0373a8e.js"><link rel="prefetch" href="/assets/js/102.2e164261.js"><link rel="prefetch" href="/assets/js/103.f4f02113.js"><link rel="prefetch" href="/assets/js/104.6941ad63.js"><link rel="prefetch" href="/assets/js/105.4b17e762.js"><link rel="prefetch" href="/assets/js/106.cb98eb1f.js"><link rel="prefetch" href="/assets/js/107.c43ae8b0.js"><link rel="prefetch" href="/assets/js/108.2eeda12b.js"><link rel="prefetch" href="/assets/js/109.502c540d.js"><link rel="prefetch" href="/assets/js/11.3e43f2d2.js"><link rel="prefetch" href="/assets/js/110.c71e2fc3.js"><link rel="prefetch" href="/assets/js/111.91b2e6e2.js"><link rel="prefetch" href="/assets/js/112.232e4837.js"><link rel="prefetch" href="/assets/js/113.14573f0e.js"><link rel="prefetch" href="/assets/js/114.ae082123.js"><link rel="prefetch" href="/assets/js/115.ed726878.js"><link rel="prefetch" href="/assets/js/116.e8de27e5.js"><link rel="prefetch" href="/assets/js/117.c295ab5a.js"><link rel="prefetch" href="/assets/js/118.849478ba.js"><link rel="prefetch" href="/assets/js/119.c561f8a3.js"><link rel="prefetch" href="/assets/js/12.20e0ccdc.js"><link rel="prefetch" href="/assets/js/120.5b801729.js"><link rel="prefetch" href="/assets/js/121.049de9db.js"><link rel="prefetch" href="/assets/js/122.c5e6bf71.js"><link rel="prefetch" href="/assets/js/123.a36a7037.js"><link rel="prefetch" href="/assets/js/124.ad02d9bf.js"><link rel="prefetch" href="/assets/js/125.dca25fd2.js"><link rel="prefetch" href="/assets/js/126.449ebd4f.js"><link rel="prefetch" href="/assets/js/127.ea432f9f.js"><link rel="prefetch" href="/assets/js/128.5da604a3.js"><link rel="prefetch" href="/assets/js/129.a07ab6fb.js"><link rel="prefetch" href="/assets/js/13.c1d17e53.js"><link rel="prefetch" href="/assets/js/130.547f04fd.js"><link rel="prefetch" href="/assets/js/131.955fb391.js"><link rel="prefetch" href="/assets/js/132.dd90237e.js"><link rel="prefetch" href="/assets/js/133.bbc693e6.js"><link rel="prefetch" href="/assets/js/134.d5a1f318.js"><link rel="prefetch" href="/assets/js/135.cffb629f.js"><link rel="prefetch" href="/assets/js/136.e0d5934d.js"><link rel="prefetch" href="/assets/js/137.18b3c0c9.js"><link rel="prefetch" href="/assets/js/138.3f0189ff.js"><link rel="prefetch" href="/assets/js/139.9c66c18b.js"><link rel="prefetch" href="/assets/js/14.b28417b7.js"><link rel="prefetch" href="/assets/js/140.7926230f.js"><link rel="prefetch" href="/assets/js/141.643b9940.js"><link rel="prefetch" href="/assets/js/142.aa16b13b.js"><link rel="prefetch" href="/assets/js/143.2d8c311f.js"><link rel="prefetch" href="/assets/js/144.0df65aa7.js"><link rel="prefetch" href="/assets/js/145.d7c6a1bc.js"><link rel="prefetch" href="/assets/js/146.e1176dfa.js"><link rel="prefetch" href="/assets/js/147.befb98bc.js"><link rel="prefetch" href="/assets/js/148.ac234fc6.js"><link rel="prefetch" href="/assets/js/149.285400ae.js"><link rel="prefetch" href="/assets/js/15.5a9a52f1.js"><link rel="prefetch" href="/assets/js/150.0fa16fa7.js"><link rel="prefetch" href="/assets/js/151.bbb524c8.js"><link rel="prefetch" href="/assets/js/152.8e261091.js"><link rel="prefetch" href="/assets/js/153.95cc0244.js"><link rel="prefetch" href="/assets/js/154.8ba5f5a8.js"><link rel="prefetch" href="/assets/js/155.a85c724d.js"><link rel="prefetch" href="/assets/js/156.3443ad8c.js"><link rel="prefetch" href="/assets/js/157.09ae4959.js"><link rel="prefetch" href="/assets/js/158.654519df.js"><link rel="prefetch" href="/assets/js/159.17c8a2bb.js"><link rel="prefetch" href="/assets/js/16.01c9f228.js"><link rel="prefetch" href="/assets/js/160.b9f7ebbf.js"><link rel="prefetch" href="/assets/js/161.2a8b4a27.js"><link rel="prefetch" href="/assets/js/162.e74e7ae9.js"><link rel="prefetch" href="/assets/js/163.702954f8.js"><link rel="prefetch" href="/assets/js/164.62f96a60.js"><link rel="prefetch" href="/assets/js/165.dbbfcccd.js"><link rel="prefetch" href="/assets/js/166.5d6f221e.js"><link rel="prefetch" href="/assets/js/167.e90d21ed.js"><link rel="prefetch" href="/assets/js/168.80299bbf.js"><link rel="prefetch" href="/assets/js/169.4ce4556b.js"><link rel="prefetch" href="/assets/js/17.99723c29.js"><link rel="prefetch" href="/assets/js/170.9c35722a.js"><link rel="prefetch" href="/assets/js/171.d22f733b.js"><link rel="prefetch" href="/assets/js/172.c493252a.js"><link rel="prefetch" href="/assets/js/173.9e78ca39.js"><link rel="prefetch" href="/assets/js/174.a4c507a8.js"><link rel="prefetch" href="/assets/js/175.1b0dd19e.js"><link rel="prefetch" href="/assets/js/176.2cc449c7.js"><link rel="prefetch" href="/assets/js/177.19b23258.js"><link rel="prefetch" href="/assets/js/178.175553e9.js"><link rel="prefetch" href="/assets/js/179.0c360c80.js"><link rel="prefetch" href="/assets/js/18.e6bd29de.js"><link rel="prefetch" href="/assets/js/180.36f991bb.js"><link rel="prefetch" href="/assets/js/181.494f6fe1.js"><link rel="prefetch" href="/assets/js/182.a7b1437e.js"><link rel="prefetch" href="/assets/js/183.0ca98de9.js"><link rel="prefetch" href="/assets/js/184.c27ac576.js"><link rel="prefetch" href="/assets/js/185.8d2a8ce2.js"><link rel="prefetch" href="/assets/js/186.8320d0d3.js"><link rel="prefetch" href="/assets/js/187.3a58b857.js"><link rel="prefetch" href="/assets/js/188.533d6dd1.js"><link rel="prefetch" href="/assets/js/189.71895955.js"><link rel="prefetch" href="/assets/js/19.862e6188.js"><link rel="prefetch" href="/assets/js/190.57301170.js"><link rel="prefetch" href="/assets/js/191.5ced6279.js"><link rel="prefetch" href="/assets/js/192.f602706c.js"><link rel="prefetch" href="/assets/js/193.c230fdfe.js"><link rel="prefetch" href="/assets/js/194.2d4555a1.js"><link rel="prefetch" href="/assets/js/195.28b7fc5f.js"><link rel="prefetch" href="/assets/js/196.afb25a39.js"><link rel="prefetch" href="/assets/js/197.9e2a3e70.js"><link rel="prefetch" href="/assets/js/198.fc5ac4d5.js"><link rel="prefetch" href="/assets/js/199.d644426a.js"><link rel="prefetch" href="/assets/js/20.6ebbd84b.js"><link rel="prefetch" href="/assets/js/201.a29d8f59.js"><link rel="prefetch" href="/assets/js/202.d3e94008.js"><link rel="prefetch" href="/assets/js/203.f3e3e868.js"><link rel="prefetch" href="/assets/js/204.402087b0.js"><link rel="prefetch" href="/assets/js/205.0e9c563c.js"><link rel="prefetch" href="/assets/js/206.2f04cc48.js"><link rel="prefetch" href="/assets/js/207.5335262e.js"><link rel="prefetch" href="/assets/js/208.cc56a2db.js"><link rel="prefetch" href="/assets/js/209.1d8d70af.js"><link rel="prefetch" href="/assets/js/21.90fed1a4.js"><link rel="prefetch" href="/assets/js/210.b9574589.js"><link rel="prefetch" href="/assets/js/211.172134d8.js"><link rel="prefetch" href="/assets/js/212.2c53f3fc.js"><link rel="prefetch" href="/assets/js/213.53b7e69e.js"><link rel="prefetch" href="/assets/js/214.bdc515b9.js"><link rel="prefetch" href="/assets/js/215.258e6ccd.js"><link rel="prefetch" href="/assets/js/216.2ce2644d.js"><link rel="prefetch" href="/assets/js/217.55248a63.js"><link rel="prefetch" href="/assets/js/218.f5f8322c.js"><link rel="prefetch" href="/assets/js/22.dce8f16a.js"><link rel="prefetch" href="/assets/js/23.0007a4fa.js"><link rel="prefetch" href="/assets/js/24.6d01ee87.js"><link rel="prefetch" href="/assets/js/25.9391c65b.js"><link rel="prefetch" href="/assets/js/26.bab0f44e.js"><link rel="prefetch" href="/assets/js/27.07f6c502.js"><link rel="prefetch" href="/assets/js/28.3cc25ea1.js"><link rel="prefetch" href="/assets/js/29.9ef34349.js"><link rel="prefetch" href="/assets/js/3.d0da32d2.js"><link rel="prefetch" href="/assets/js/30.73ad71b5.js"><link rel="prefetch" href="/assets/js/31.befb5dcc.js"><link rel="prefetch" href="/assets/js/32.59543864.js"><link rel="prefetch" href="/assets/js/33.ae1a0e3f.js"><link rel="prefetch" href="/assets/js/34.2078ba0e.js"><link rel="prefetch" href="/assets/js/35.edb8d8ae.js"><link rel="prefetch" href="/assets/js/36.87eed27a.js"><link rel="prefetch" href="/assets/js/37.81da457a.js"><link rel="prefetch" href="/assets/js/38.2df10397.js"><link rel="prefetch" href="/assets/js/39.467edd51.js"><link rel="prefetch" href="/assets/js/4.35c857e9.js"><link rel="prefetch" href="/assets/js/40.5de45dc6.js"><link rel="prefetch" href="/assets/js/41.d309118f.js"><link rel="prefetch" href="/assets/js/42.98342fd7.js"><link rel="prefetch" href="/assets/js/43.84d0a1d9.js"><link rel="prefetch" href="/assets/js/44.eadf3c86.js"><link rel="prefetch" href="/assets/js/45.397ba613.js"><link rel="prefetch" href="/assets/js/46.b906e3d9.js"><link rel="prefetch" href="/assets/js/47.2c1c5f69.js"><link rel="prefetch" href="/assets/js/48.476665ad.js"><link rel="prefetch" href="/assets/js/49.0e8c54c1.js"><link rel="prefetch" href="/assets/js/50.92e125aa.js"><link rel="prefetch" href="/assets/js/51.d7ba9f7b.js"><link rel="prefetch" href="/assets/js/52.9b5cc3a9.js"><link rel="prefetch" href="/assets/js/53.959aee41.js"><link rel="prefetch" href="/assets/js/54.5ebb4b43.js"><link rel="prefetch" href="/assets/js/55.50ce176c.js"><link rel="prefetch" href="/assets/js/56.5b93e0c3.js"><link rel="prefetch" href="/assets/js/57.9fb20ef8.js"><link rel="prefetch" href="/assets/js/58.4969e74a.js"><link rel="prefetch" href="/assets/js/59.55cf8cc4.js"><link rel="prefetch" href="/assets/js/6.97521e82.js"><link rel="prefetch" href="/assets/js/60.e2058288.js"><link rel="prefetch" href="/assets/js/61.963b8be8.js"><link rel="prefetch" href="/assets/js/62.ba494309.js"><link rel="prefetch" href="/assets/js/63.08e5b586.js"><link rel="prefetch" href="/assets/js/64.e70bb248.js"><link rel="prefetch" href="/assets/js/65.ca0a0192.js"><link rel="prefetch" href="/assets/js/66.4a72f0c0.js"><link rel="prefetch" href="/assets/js/67.19088f90.js"><link rel="prefetch" href="/assets/js/68.7e681b7e.js"><link rel="prefetch" href="/assets/js/69.cd6b0eb7.js"><link rel="prefetch" href="/assets/js/7.5b349176.js"><link rel="prefetch" href="/assets/js/70.477cd8a4.js"><link rel="prefetch" href="/assets/js/71.522dd83b.js"><link rel="prefetch" href="/assets/js/72.da123f45.js"><link rel="prefetch" href="/assets/js/73.7315b4a0.js"><link rel="prefetch" href="/assets/js/74.38691c02.js"><link rel="prefetch" href="/assets/js/75.69588ec8.js"><link rel="prefetch" href="/assets/js/76.76ebaeec.js"><link rel="prefetch" href="/assets/js/77.ed1bc3b4.js"><link rel="prefetch" href="/assets/js/78.3598eae0.js"><link rel="prefetch" href="/assets/js/79.bcf4b802.js"><link rel="prefetch" href="/assets/js/8.8c07dbf6.js"><link rel="prefetch" href="/assets/js/80.b3eed4c3.js"><link rel="prefetch" href="/assets/js/81.aeac8524.js"><link rel="prefetch" href="/assets/js/82.4cce227a.js"><link rel="prefetch" href="/assets/js/83.9ab4515e.js"><link rel="prefetch" href="/assets/js/84.da096ddd.js"><link rel="prefetch" href="/assets/js/85.0b990a59.js"><link rel="prefetch" href="/assets/js/86.53640fe5.js"><link rel="prefetch" href="/assets/js/87.e78863bd.js"><link rel="prefetch" href="/assets/js/88.131db494.js"><link rel="prefetch" href="/assets/js/89.e07091e8.js"><link rel="prefetch" href="/assets/js/9.b68e9323.js"><link rel="prefetch" href="/assets/js/90.94403454.js"><link rel="prefetch" href="/assets/js/91.038c9e69.js"><link rel="prefetch" href="/assets/js/92.c712aa47.js"><link rel="prefetch" href="/assets/js/93.4ed20a92.js"><link rel="prefetch" href="/assets/js/94.f1e36981.js"><link rel="prefetch" href="/assets/js/95.2f2c46ff.js"><link rel="prefetch" href="/assets/js/96.fc3b9cb6.js"><link rel="prefetch" href="/assets/js/97.75efe0d4.js"><link rel="prefetch" href="/assets/js/98.318d425b.js"><link rel="prefetch" href="/assets/js/99.3aa7b1ca.js">
    <link rel="stylesheet" href="/assets/css/0.styles.35fe7a73.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/favicon.png" alt="云开发-一站式后端云服务" class="logo"> <span class="site-name can-hide">云开发-一站式后端云服务</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">快速入门</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/2019-09-03-wx-dev-guide-summary/" class="nav-link">小程序</a></li><li class="dropdown-item"><!----> <a href="/2019-09-03-web-dev-guide-summary/" class="nav-link">Web</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/2019-10-16-base-feature/" class="nav-link">基础能力</a></li><li class="dropdown-item"><!----> <a href="/2019-09-03-value-added-cloud-introduction/" class="nav-link">增值能力</a></li><li class="dropdown-item"><!----> <a href="/2019-10-10-sdk-summary/" class="nav-link">SDK文档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">生态</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>开发者工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/2019-09-03-cli/" class="nav-link">CLI工具</a></li></ul></li><li class="dropdown-item"><h4>技术沙龙</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://mp.weixin.qq.com/s/nFCtlERfhv2FMrNgHei7cQ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  训练营
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://mp.weixin.qq.com/s/ENA2TAJ2fHtyMgFQ5kbBAA" target="_blank" rel="noopener noreferrer" class="nav-link external">
  校园技术工坊
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="/activities/wcc/" class="nav-link">云开发技术圈</a></li></ul></li><li class="dropdown-item"><h4>资源列表</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/TencentCloudBase/awesome-tcb" target="_blank" rel="noopener noreferrer" class="nav-link external">
  云开发资源
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://github.com/TencentCloudBase" target="_blank" rel="noopener noreferrer" class="nav-link external">
  团队主页
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>开源生态</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/2019-10-28-opensource-guidelines/" class="nav-link">开源生态协同</a></li><li class="dropdown-subitem"><a href="/2019-11-12-taskcoding-guidelines/" class="nav-link">Task Coding</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/2019-09-03-share-miniprogram-cloud-basic-concept/" class="nav-link">视频教程</a></li><li class="dropdown-item"><!----> <a href="/2019-09-03-share-tree-hole/" class="nav-link">官方案例</a></li><li class="dropdown-item"><!----> <a href="/2019-09-03-share-maoyan/" class="nav-link">项目实战</a></li><li class="dropdown-item"><!----> <a href="https://github.com/TencentCloudBase/blog/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  案例提交
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="/feedback/" class="nav-link">问题反馈</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">更多</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://cloud.tencent.com/product/tcb" target="_blank" rel="noopener noreferrer" class="nav-link external">
  官方主页
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://cloud.tencent.com/developer/team/tcb" target="_blank" rel="noopener noreferrer" class="nav-link external">
  云+社区
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/TencentCloudBase/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">快速入门</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/2019-09-03-wx-dev-guide-summary/" class="nav-link">小程序</a></li><li class="dropdown-item"><!----> <a href="/2019-09-03-web-dev-guide-summary/" class="nav-link">Web</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">文档</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/2019-10-16-base-feature/" class="nav-link">基础能力</a></li><li class="dropdown-item"><!----> <a href="/2019-09-03-value-added-cloud-introduction/" class="nav-link">增值能力</a></li><li class="dropdown-item"><!----> <a href="/2019-10-10-sdk-summary/" class="nav-link">SDK文档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">生态</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>开发者工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/2019-09-03-cli/" class="nav-link">CLI工具</a></li></ul></li><li class="dropdown-item"><h4>技术沙龙</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://mp.weixin.qq.com/s/nFCtlERfhv2FMrNgHei7cQ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  训练营
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://mp.weixin.qq.com/s/ENA2TAJ2fHtyMgFQ5kbBAA" target="_blank" rel="noopener noreferrer" class="nav-link external">
  校园技术工坊
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="/activities/wcc/" class="nav-link">云开发技术圈</a></li></ul></li><li class="dropdown-item"><h4>资源列表</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/TencentCloudBase/awesome-tcb" target="_blank" rel="noopener noreferrer" class="nav-link external">
  云开发资源
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://github.com/TencentCloudBase" target="_blank" rel="noopener noreferrer" class="nav-link external">
  团队主页
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>开源生态</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/2019-10-28-opensource-guidelines/" class="nav-link">开源生态协同</a></li><li class="dropdown-subitem"><a href="/2019-11-12-taskcoding-guidelines/" class="nav-link">Task Coding</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">学习</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/2019-09-03-share-miniprogram-cloud-basic-concept/" class="nav-link">视频教程</a></li><li class="dropdown-item"><!----> <a href="/2019-09-03-share-tree-hole/" class="nav-link">官方案例</a></li><li class="dropdown-item"><!----> <a href="/2019-09-03-share-maoyan/" class="nav-link">项目实战</a></li><li class="dropdown-item"><!----> <a href="https://github.com/TencentCloudBase/blog/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  案例提交
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="/feedback/" class="nav-link">问题反馈</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">更多</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://cloud.tencent.com/product/tcb" target="_blank" rel="noopener noreferrer" class="nav-link external">
  官方主页
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://cloud.tencent.com/developer/team/tcb" target="_blank" rel="noopener noreferrer" class="nav-link external">
  云+社区
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/TencentCloudBase/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>视频教程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading open"><span>基础教程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-miniprogram-cloud-basic-concept/" class="sidebar-link">小程序-云开发-概念基础</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-operation/" class="sidebar-link">小程序-云开发-操作基础</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-api/" class="sidebar-link">小程序-云开发-云开发API基础</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>中级课程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-miniprogram-cloud-middle-scf/" class="sidebar-link">小程序-云开发-云函数项目实战</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-middle-db/" class="sidebar-link">小程序-云开发-数据库项目实战</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-middle-cos/" class="sidebar-link">小程序-云开发-文件存储项目实战</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>高阶实战</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-miniprogram-cloud-advanced-wechat-pay/" class="sidebar-link">巧借 [ 小程序云开发 ] 快速接入微信支付功能</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-advanced-bookcase/" class="sidebar-link">小程序-云开发-私房书柜项目实战</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-advanced-music-player/" class="sidebar-link">从0到1实现音乐播放器小程序</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>小程序-云开发基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-miniprogram-cloud-basic-learn/" class="sidebar-link">了解云开发基础</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-db/" class="sidebar-link">云开发数据库能力介绍</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-db-permission/" class="sidebar-link">云开发数据库权限介绍</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-cos-storage/" class="sidebar-link">云开发文件存储能力介绍</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-scf-timer/" class="sidebar-link">云函数基础用法之定时器</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-practice-todo/" class="sidebar-link">云开发实战之 TODO</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-scf-db/" class="sidebar-link">云函数应用之数据库操作</a></li><li><a href="/2019-09-03-share-miniprogram-cloud-basic-scf-features/" class="sidebar-link">云函数应用之功能操作</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>小游戏-云开发实战</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-minigame-cloud-introduction/" class="sidebar-link">云开发介绍</a></li><li><a href="/2019-09-03-share-minigame-cloud-basic/" class="sidebar-link">游戏云开发基础</a></li><li><a href="/2019-09-03-share-minigame-cloud-login-register/" class="sidebar-link">用户登录注册</a></li><li><a href="/2019-09-03-share-minigame-cloud-share/" class="sidebar-link">小游戏分享</a></li><li><a href="/2019-09-03-share-minigame-cloud-practice/" class="sidebar-link">小游戏实现</a></li><li><a href="/2019-09-03-share-minigame-cloud-ad/" class="sidebar-link">广告接入</a></li><li><a href="/2019-09-03-share-minigame-cloud-pay/" class="sidebar-link">云开发支付</a></li></ul></section></li><li><section class="sidebar-group is-sub-group depth-1"><p class="sidebar-heading"><span>电商小程序-云开发初探</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-e-commerce-introduction/" class="sidebar-link">课程介绍</a></li><li><a href="/2019-09-03-share-e-commerce-personal/" class="sidebar-link">个人中心</a></li><li><a href="/2019-09-03-share-e-commerce-preview/" class="sidebar-link">电商小程序雏形</a></li><li><a href="/2019-09-03-share-e-commerce-features-first/" class="sidebar-link">电商通用功能-上</a></li><li><a href="/2019-09-03-share-e-commerce-features-second/" class="sidebar-link">电商通用功能-下</a></li><li><a href="/2019-09-03-share-e-commerce-marketing/" class="sidebar-link">电商业务营销功能</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>官方案例</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-tree-hole/" class="sidebar-link">树洞小程序</a></li><li><a href="/2019-09-03-share-forum/" class="sidebar-link">论坛小程序</a></li><li><a href="/2019-09-03-share-album/" class="sidebar-link">相册小程序</a></li><li><a href="/2019-09-03-share-ai-card/" class="sidebar-link">AI名片小程序</a></li><li><a href="/2019-09-03-share-beauty-album/" class="sidebar-link">智能美颜相册小程序</a></li><li><a href="/2019-09-03-share-gomoku/" class="sidebar-link">在线对战五子棋小游戏</a></li><li><a href="/2019-09-03-share-food-map/" class="sidebar-link">美食地图小程序</a></li><li><a href="/2019-09-18-share-SCRM/" class="sidebar-link">SCRM小程序</a></li><li><a href="/2019-09-26-share-avatar/" class="sidebar-link">头像小程序</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>项目实战</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/2019-09-03-share-maoyan/" class="sidebar-link">猫眼</a></li><li><a href="/2019-09-03-share-zhuanzhuan/" class="sidebar-link">转转</a></li><li><a href="/2019-09-03-share-lexiang-garden/" class="sidebar-link">乐享花园</a></li><li><a href="/2019-09-03-share-cat-room/" class="sidebar-link">猫咪公寓</a></li><li><a href="/2019-09-03-share-tg-idea/" class="sidebar-link">TGidea</a></li><li><a href="/2019-09-03-share-taro-shop/" class="sidebar-link">Taro商城</a></li><li><a href="/2019-09-03-share-more-articles/" class="sidebar-link">更多教程文章</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="旅行小账本"><a href="#旅行小账本" aria-hidden="true" class="header-anchor">#</a> 旅行小账本</h1> <h1 id="ide"><a href="#ide" aria-hidden="true" class="header-anchor">#</a> IDE</h1> <ul><li><a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html?t=201822" target="_blank" rel="noopener noreferrer">微信开发者工具<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://code.visualstudio.com/Download" target="_blank" rel="noopener noreferrer">VSCode<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br>
小程序开发必然少不了微信开发者工具，再加上其对云开发的全面支持，再好不过的开发利器。但熟悉微信开发者工具的朋友们应该知道，它不支持<a href="https://www.cnblogs.com/cnjava/p/3225174.html" target="_blank" rel="noopener noreferrer">Emmet缩写语法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，并且wxml的属性值默认用单引号表示(强迫症表示很难受)。
而VSCode很好的补足了微信开发者工具的不足之处，并且支持多元化<a href="https://juejin.im/post/5a08d1d6f265da430f31950e" target="_blank" rel="noopener noreferrer">插件开发<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，轻量好用。<br>
所以这里推荐采用微信开发者工具+VSCode配合开发。微信开发者工具负责调试、模拟小程序运行情况，VSCode负责代码编辑工作。二者各司其职，会使开发更加的高效、便捷</li></ul> <h1 id="总体架构"><a href="#总体架构" aria-hidden="true" class="header-anchor">#</a> 总体架构</h1> <p>该项目基于小程序云开发，使用的模板是<a href="https://cloud.tencent.com/developer/article/1345310" target="_blank" rel="noopener noreferrer">云开发快速启动模板<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br>
由于是个全栈项目，前端使用小程序所支持的wxml + wxss + js开发模式，命名采用<a href="https://juejin.im/post/5bb4678a5188255c980be9d2" target="_blank" rel="noopener noreferrer">BEM<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>命名规范。后台则是借助云数据库+云储存进行数据管理。</p> <h4 id="项目总体结构"><a href="#项目总体结构" aria-hidden="true" class="header-anchor">#</a> 项目总体结构</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">|</span><span class="token operator">-</span>travelbook  项目名
    <span class="token operator">|</span><span class="token operator">-</span>cloudfunctions  云函数模块
        <span class="token operator">|</span><span class="token operator">-</span>deleteItems 级联删除<span class="token operator">--</span>云函数
        <span class="token operator">|</span><span class="token operator">-</span>getTime     获取时间<span class="token operator">--</span>云函数
    <span class="token operator">|</span><span class="token operator">-</span>miniprogram  项目模块
        <span class="token operator">|</span><span class="token operator">-</span>components  自定义组件
            <span class="token operator">|</span><span class="token operator">-</span>accountCover  账本封面组件
            <span class="token operator">|</span><span class="token operator">-</span>spendDetail   支出细节组件
        <span class="token operator">|</span><span class="token operator">-</span>pages  页面
            <span class="token operator">|</span><span class="token operator">-</span>accountBooks     总账本页
            <span class="token operator">|</span><span class="token operator">-</span>accountCalendar  账本日历页
            <span class="token operator">|</span><span class="token operator">-</span>accountDetail    支出细节页
            <span class="token operator">|</span><span class="token operator">-</span>accountList      支出明细页
            <span class="token operator">|</span><span class="token operator">-</span>accountPage      选定账本页
            <span class="token operator">|</span><span class="token operator">-</span>editAccount      账本编辑页
            <span class="token operator">|</span><span class="token operator">-</span>index            首页
        <span class="token operator">|</span><span class="token operator">-</span>vant<span class="token operator">-</span>weapp   有赞vant框架组件库
            <span class="token operator">|</span><span class="token operator">-</span>···      系列组件<span class="token operator">...</span>
        app<span class="token punctuation">.</span>js         全局js
        app<span class="token punctuation">.</span>json       全局json配置
        app<span class="token punctuation">.</span>wxss       全局wxss
</code></pre></div><h1 id="逆向工程"><a href="#逆向工程" aria-hidden="true" class="header-anchor">#</a> 逆向工程</h1> <p>在做该小程序之前，有必要进行项目的逆向工程，进一步解构每一个页面，从而深入了解这款小程序的交互细节。那么现在我假设自己为腾讯旅游的产品设计师，在绘制完界面原型后，撰写了相应的交互文档。当然解构过程中可能有些细节处理并没有那么仔细到位...<br>
以下是我绘制的界面原型
<img src="https://puui.qpic.cn/vupload/0/20190618_1560841685577_ez53lrmq4ji.jpeg/0" alt=""> <img src="https://puui.qpic.cn/vupload/0/20190618_1560841745416_ilo7zykytkc.jpeg/0" alt=""> <img src="https://puui.qpic.cn/vupload/0/20190618_1560841810370_zxgzdholi6j.png/0" alt="">
接下来对每个页面的细节进行解构，并完成简单的wxml结构
<img src="https://puui.qpic.cn/vupload/0/20190618_1560841863494_r2jb1rjjxz.png/0" alt=""></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>switchList使用定位布局<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view bindtap<span class="token operator">=</span><span class="token string">&quot;switchList&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;list&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>newAccount使用flex布局<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;newAccount&quot;</span> bindtap<span class="token operator">=</span><span class="token string">&quot;createNewAccount&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;desc&quot;</span><span class="token operator">&gt;</span>旅行中的每一笔开支都有独特的意义！<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">&quot;{{}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;title&quot;</span><span class="token operator">&gt;</span>创建一个新账本<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
</code></pre></div><p><img src="https://puui.qpic.cn/vupload/0/20190618_1560841983381_9t2npq4e0lc.jpeg/0" alt=""></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>整体用flex <span class="token operator">+</span> 百分比布局<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;accuntName&quot;</span> placeholder<span class="token operator">=</span><span class="token string">&quot;旅行账本名称&quot;</span> bindinput<span class="token operator">=</span><span class="token string">&quot;getInput&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
  
<span class="token operator">&lt;</span>van<span class="token operator">-</span>panel title<span class="token operator">=</span><span class="token string">&quot;选择封面&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;panel&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>van<span class="token operator">-</span>row <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;imageBox&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>使用wx<span class="token punctuation">:</span><span class="token keyword">for</span>遍历数据库账本图片信息<span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>van<span class="token operator">-</span>col span<span class="token operator">=</span><span class="token string">&quot;8&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;imgCol&quot;</span> bindtap<span class="token operator">=</span><span class="token string">&quot;selectThis&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>image <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;select&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;{{}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>col<span class="token operator">&gt;</span>
        
        <span class="token operator">&lt;</span>van<span class="token operator">-</span>col span<span class="token operator">=</span><span class="token string">&quot;8&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;addBox&quot;</span> bindtap<span class="token operator">=</span><span class="token string">&quot;useMore&quot;</span><span class="token operator">&gt;</span>更多封面<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>col<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>row<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>panel<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">&quot;primary&quot;</span> bindtap<span class="token operator">=</span><span class="token string">&quot;save&quot;</span><span class="token operator">&gt;</span>保存<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button type<span class="token operator">=</span><span class="token string">&quot;warn&quot;</span> bindtap<span class="token operator">=</span><span class="token string">&quot;delete&quot;</span><span class="token operator">&gt;</span>删除<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
</code></pre></div><p><img src="https://puui.qpic.cn/vupload/0/20190618_1560842059815_nfusyuuau7.png/0" alt=""></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;accountDesc&quot;</span> bindtap<span class="token operator">=</span><span class="token string">&quot;viewDetail&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>使用wx<span class="token punctuation">:</span><span class="token keyword">for</span>遍历数据库账本信息<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;accountName&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;accountTime&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>绝对定位<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>image <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;updateImg&quot;</span> catchtap<span class="token operator">=</span><span class="token string">&quot;editAccount&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;{{}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
</code></pre></div><p><img src="https://puui.qpic.cn/vupload/0/20190618_1560842184322_kfrsl4rpv6p.png/0" alt=""></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>switchList使用定位布局<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view bindtap<span class="token operator">=</span><span class="token string">&quot;switchList&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;list&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__list-year&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__list-new account__list-public&quot;</span> bindtap<span class="token operator">=</span><span class="token string">&quot;createNewAccount&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>日期小圆点<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__list-point&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__list-time&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">&quot;{{}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__list-title&quot;</span><span class="token operator">&gt;</span>创建一个新账本<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>使用wx<span class="token punctuation">:</span><span class="token keyword">for</span>遍历数据库账本信息<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__list-item account__list-public&quot;</span> bindtap<span class="token operator">=</span><span class="token string">&quot;viewDetail&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>日期小圆点<span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__list-point&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">&quot;{{}}&quot;</span> mode<span class="token operator">=</span><span class="token string">&quot;aspectFill&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__list-name&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__list-time&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>image <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__list-update&quot;</span> catchtap<span class="token operator">=</span><span class="token string">&quot;editAccount&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;{{}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
 <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
</code></pre></div><p><img src="https://puui.qpic.cn/vupload/0/20190618_1560842250801_o1qdpeigrhr.jpeg/0" alt=""></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__spend&quot;</span><span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>image bindtap<span class="token operator">=</span><span class="token string">&quot;getCalendar&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__spend-calendar&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;{{}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__spend-text&quot;</span><span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__spend-total&quot;</span><span class="token operator">&gt;</span><span class="token function">总花费</span><span class="token punctuation">(</span>元<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__spend-num&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>image bindtap<span class="token operator">=</span><span class="token string">&quot;accountAnalyze&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__spend-detail&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;{{}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__show-time&quot;</span><span class="token operator">&gt;</span>今天<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__show-detail&quot;</span><span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__show-income account__show-public&quot;</span><span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__show-title&quot;</span><span class="token operator">&gt;</span><span class="token function">收入</span><span class="token punctuation">(</span>元<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__show-in&quot;</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__show-spend account__show-public&quot;</span><span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__show-title&quot;</span><span class="token operator">&gt;</span><span class="token function">支出</span><span class="token punctuation">(</span>元<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__show-out&quot;</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>使用wx<span class="token punctuation">:</span><span class="token keyword">for</span>遍历数据库账本信息<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__show-items-spend&quot;</span><span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>view<span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">&quot;{{}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
   <span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__show-items-money&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
</code></pre></div><p><img src="https://puui.qpic.cn/vupload/0/20190618_1560842373409_km8tjmyscql.png/0" alt=""></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>日历使用极点日历的插件<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>json中做配置<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token string">&quot;usingComponents&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;calendar&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;plugin://calendar/calendar&quot;</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>js改变样式<span class="token operator">--</span><span class="token operator">&gt;</span>
days_style<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  month<span class="token punctuation">:</span> <span class="token string">'current'</span><span class="token punctuation">,</span>
  day<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  color<span class="token punctuation">:</span> <span class="token string">'white'</span><span class="token punctuation">,</span>
  background<span class="token punctuation">:</span> <span class="token string">'#e0a58e'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>wxml中引用<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>calendar weeks<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">&quot;cn&quot;</span> cell<span class="token operator">-</span>size<span class="token operator">=</span><span class="token string">&quot;50&quot;</span> next<span class="token operator">=</span><span class="token string">&quot;{{true}}&quot;</span> prev<span class="token operator">=</span><span class="token string">&quot;{{true}}&quot;</span>
    show<span class="token operator">-</span>more<span class="token operator">-</span>days<span class="token operator">=</span><span class="token string">&quot;{{true}}&quot;</span> calendar<span class="token operator">-</span>style<span class="token operator">=</span><span class="token string">&quot;demo6-calendar&quot;</span>
    header<span class="token operator">-</span>style<span class="token operator">=</span><span class="token string">&quot;calendar-header&quot;</span>board<span class="token operator">-</span>style<span class="token operator">=</span><span class="token string">&quot;calendar-board&quot;</span> active<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">&quot;rounded&quot;</span> 
    lunar<span class="token operator">=</span><span class="token string">&quot;true&quot;</span> header<span class="token operator">-</span>style<span class="token operator">=</span><span class="token string">&quot;header&quot;</span>calendar<span class="token operator">-</span>style<span class="token operator">=</span><span class="token string">&quot;calendar&quot;</span>days<span class="token operator">-</span>color<span class="token operator">=</span><span class="token string">&quot;{{days_style}}&quot;</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>calendar<span class="token operator">&gt;</span>
</code></pre></div><p><img src="https://puui.qpic.cn/vupload/0/20190618_1560842442806_i03eiats4d.png/0" alt=""></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>顶栏日期及收支结构<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__title&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__title-time&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>text <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__title-spend&quot;</span><span class="token operator">&gt;</span>支出<span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>元 收入<span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>元<span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>收支细节结构 使用flex弹性布局<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__detail&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">&quot;{{}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__detail-name&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;account__detail-money&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
</code></pre></div><p><img src="https://puui.qpic.cn/vupload/0/20190618_1560842599626_eqbucxicxre.png/0" alt=""></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>使用vant框架的van<span class="token operator">-</span>tabs组件<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>并封装自定义组件复用收支页，自定义组件后面会详细说明<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>van<span class="token operator">-</span>tabs active<span class="token operator">=</span><span class="token string">&quot;{{ active }}&quot;</span> bind<span class="token punctuation">:</span>change<span class="token operator">=</span><span class="token string">&quot;onChange&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>van<span class="token operator">-</span>tab title<span class="token operator">=</span><span class="token string">&quot;支出&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>spendDetail detail<span class="token operator">=</span><span class="token string">&quot;{{detail}}&quot;</span> accountKey<span class="token operator">=</span><span class="token string">&quot;{{accountKey}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>spendDetail<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>tab<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>van<span class="token operator">-</span>tab title<span class="token operator">=</span><span class="token string">&quot;收入&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>spendDetail detail<span class="token operator">=</span><span class="token string">&quot;{{income}}&quot;</span> accountKey<span class="token operator">=</span><span class="token string">&quot;{{accountKey}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>spendDetail<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>tab<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>tabs<span class="token operator">&gt;</span>
</code></pre></div><h1 id="云开发"><a href="#云开发" aria-hidden="true" class="header-anchor">#</a> 云开发</h1> <p>在做完逆向工程的解构，页面基础结构基本搭建完成。但页面依旧是静态的，需要数据来填充。所以第二步就是数据库的设计。而小程序的云控制台恰好提供了数据的操作功能，为数据驱动提供基石。
<img src="https://puui.qpic.cn/vupload/0/20190618_1560842693321_2iryp54j1mr.png/0" alt=""></p> <h2 id="云数据库设计"><a href="#云数据库设计" aria-hidden="true" class="header-anchor">#</a> 云数据库设计</h2> <p>云数据库是一种NoSQL数据库。每一张表是一个集合。值得注意的是在设计数据库时，<code>_id</code> 和<code>_openid</code>这两个字段需要带上。<code>_id</code>是表的主键，而<code>_openid</code>是用户标识，每个用户都有不同的<code>_openid</code>，可区分不同用户。<br>
以下是项目中的数据表设计</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>cover_photos 账本封面表  用于存储创建账本时需要的封面信息
    <span class="token operator">-</span> _id
    <span class="token operator">-</span> _openid
    <span class="token operator">-</span> cover_index 封面索引
    <span class="token operator">-</span> cover_url   封面url
    <span class="token operator">-</span> isSelected  封面是否选中
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>accounts 账本表   用于存储用户创建的账本
    <span class="token operator">-</span> _id
    <span class="token operator">-</span> _openid
    <span class="token operator">-</span> accountKey  账本唯一标识
    <span class="token operator">-</span> coverUrl    账本封面
    <span class="token operator">-</span> i           账本索引
    <span class="token operator">-</span> inputValue  账本名字
    <span class="token operator">-</span> now         账本创建时间
    <span class="token operator">-</span> spend       账本总花费
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>account_detail 支出类型表   用于存储消费类型
    <span class="token operator">-</span> _id
    <span class="token operator">-</span> _openid
    <span class="token operator">-</span> detail       类型细节
    <span class="token operator">-</span> pic_index    消费类型索引
    <span class="token operator">-</span> pic_url      未点击时的图片
    <span class="token operator">-</span> pic_url_act  点击后的图片
    <span class="token operator">-</span> type         消费类型
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>account_income 收入类型表   用于存储收入类型
    <span class="token operator">-</span> _id
    <span class="token operator">-</span> _openid
    <span class="token operator">-</span> pic_index    收入类型索引
    <span class="token operator">-</span> pic_url      未点击时的图片
    <span class="token operator">-</span> pic_url_act  点击后的图片
    <span class="token operator">-</span> type         收入类型
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>spend_items   消费明细表
    <span class="token operator">-</span> _id
    <span class="token operator">-</span> _openid
    <span class="token operator">-</span> accountKey   账本唯一标识
    <span class="token operator">-</span> address      消费地点
    <span class="token operator">-</span> desc         消费描述
    <span class="token operator">-</span> fullDate     消费时间
    <span class="token operator">-</span> money        消费金额
    <span class="token operator">-</span> pic_type     消费类型
    <span class="token operator">-</span> pic_url      消费类型图片
</code></pre></div><h2 id="云储存管理"><a href="#云储存管理" aria-hidden="true" class="header-anchor">#</a> 云储存管理</h2> <p>这是个非常实用的板块。类似于<a href="https://pan.baidu.com/" target="_blank" rel="noopener noreferrer">百度云盘<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，它提供了文件存储、上传与下载功能。
<img src="https://puui.qpic.cn/vupload/0/20190618_1560843125594_leagaa09yfi.png/0" alt="">
除此之外，它还会将你所上传的资源自动进行压缩操作，并生成一个地址供你引用。该项目中的一些图片资源就是存在于此，然后在云数据库的字段中引用这些资源地址即可，十分方便，不必在本地存储，占用小程序内存。
<img src="https://puui.qpic.cn/vupload/0/20190618_1560843165699_eczla5i3ixl.png/0" alt=""></p> <h2 id="云函数设计"><a href="#云函数设计" aria-hidden="true" class="header-anchor">#</a> 云函数设计</h2> <p><a href="https://developers.weixin.qq.com/miniprogram/dev/wxcloud/guide/functions.html" target="_blank" rel="noopener noreferrer">云函数<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>简单来说就是在云后端(Node.js)运行的代码，本地看不到这些代码的执行过程，全封闭式只暴露接口供本地调用执行，本地只需等待云端代码执行完毕后返回结果。这也是<a href="https://www.cnblogs.com/bobodeboke/p/5733422.html" target="_blank" rel="noopener noreferrer">面向接口编程<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的思想体现。<br>
项目中的云函数设计
<img src="https://puui.qpic.cn/vupload/0/20190618_1560843311997_6uz9ccu5erg.png/0" alt=""></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// getTime  获取当前时间并格式化为 yyyy-mm-dd</span>

<span class="token comment">// 云函数入口文件</span>
<span class="token keyword">const</span> cloud <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'wx-server-sdk'</span><span class="token punctuation">)</span>

<span class="token comment">// 初始化云函数</span>
cloud<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 云函数入口函数</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">main</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> seperator1 <span class="token operator">=</span> <span class="token string">&quot;-&quot;</span>
  <span class="token keyword">var</span> year <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> month <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
  <span class="token keyword">var</span> strDate <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>month <span class="token operator">&gt;=</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> month <span class="token operator">&lt;=</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    month <span class="token operator">=</span> <span class="token string">&quot;0&quot;</span> <span class="token operator">+</span> month
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>strDate <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> strDate <span class="token operator">&lt;=</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    strDate <span class="token operator">=</span> <span class="token string">&quot;0&quot;</span> <span class="token operator">+</span> strDate
  <span class="token punctuation">}</span>
  <span class="token comment">// 格式化当前时间</span>
  <span class="token keyword">var</span> currentdate <span class="token operator">=</span> year <span class="token operator">+</span> seperator1 <span class="token operator">+</span> month <span class="token operator">+</span> seperator1 <span class="token operator">+</span> strDate
  <span class="token keyword">return</span> currentdate
<span class="token punctuation">}</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// deleteItems  批量删除，云数据库的批量删除只允许在云函数中执行</span>

<span class="token comment">// 云函数入口文件</span>
<span class="token keyword">const</span> cloud <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'wx-server-sdk'</span><span class="token punctuation">)</span>

<span class="token comment">// 初始化云函数</span>
cloud<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 连接云数据库</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> cloud<span class="token punctuation">.</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> _ <span class="token operator">=</span> db<span class="token punctuation">.</span>command


<span class="token comment">// 云函数入口函数</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">main</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'spend_items'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        accountKey<span class="token punctuation">:</span> event<span class="token punctuation">.</span>accountKey
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="mvvm"><a href="#mvvm" aria-hidden="true" class="header-anchor">#</a> MVVM</h2> <p>界面有了，数据有了。万事俱备，只欠东风！所以下一步就是<a href="https://www.liaoxuefeng.com/wiki/1022910821149312/1108898947791072" target="_blank" rel="noopener noreferrer">MVVM<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的设计。小程序本质就是基于MVVM所设计的，在MVVM的世界里，数据是灵魂，一切都由数据来驱动。</p> <h2 id="账本页显示"><a href="#账本页显示" aria-hidden="true" class="header-anchor">#</a> 账本页显示</h2> <p>账本页有两种显示的风格，左上角的按钮可以来回切换风格，下拉可刷新页面，显示accounts数据表中存储的账本信息。显示时有个小细节，需要根据创建的时间先后来显示，越晚创建的越先显示。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 页面数据设计, 在wxml中使用{{}}符号引用数据，数据就动态显示到了页面上</span>
data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    isList<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 转换页面风格的标识 true为竖向风格 false为横向风格</span>
    accounts<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// 存储查询的账本数据</span>
    now<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>     <span class="token comment">// 存储当日时间</span>
    year<span class="token punctuation">:</span> <span class="token keyword">null</span>     <span class="token comment">// 存储年份</span>
<span class="token punctuation">}</span>

 <span class="token comment">// 转换显示风格</span>
<span class="token function">switchList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置页面风格样式</span>
    <span class="token keyword">let</span> isList <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>isList
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      isList
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    wx<span class="token punctuation">.</span><span class="token function">setStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      key<span class="token punctuation">:</span> <span class="token string">&quot;isList&quot;</span><span class="token punctuation">,</span>
      data<span class="token punctuation">:</span> isList
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 获取页面风格转换标识</span>
<span class="token keyword">var</span> isList <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">'isList'</span><span class="token punctuation">)</span>
    
<span class="token comment">// 查询账本</span>
db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'accounts'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">success</span><span class="token punctuation">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        accounts<span class="token punctuation">:</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">// 反转数组，优先显示创建早的账本</span>
        isList
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      wx<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 调用云函数接口 获取当前日期</span>
wx<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span><span class="token function">callFunction</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// 云函数接口名就是创建的云函数名字，这里是'getTime'</span>
    name<span class="token punctuation">:</span> <span class="token string">'getTime'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">success</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> year <span class="token operator">=</span> res<span class="token punctuation">.</span>result<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      now<span class="token punctuation">:</span> res<span class="token punctuation">.</span>result<span class="token punctuation">,</span>
      year
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    fail<span class="token punctuation">:</span> console<span class="token punctuation">.</span>error
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="账本页增删改"><a href="#账本页增删改" aria-hidden="true" class="header-anchor">#</a> 账本页增删改</h2> <p><img src="https://puui.qpic.cn/vupload/0/20190618_1560843593146_wui2kg9i3s.gif/0" alt="">
账本页通过调用相应的云数据库API，可进行一系列的增删改操作。值得一提的是，修改时需要表单回显，删除时需要级联删除。因为一个账本中有许多收支情况，spend_items表就是进行收支记录，所以删除账本时需要级联删除对应的spend_items表中的收支信息。<br>
一些重要的逻辑</p> <ul><li>封面单选逻辑</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    images<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>      <span class="token comment">// 封面数组</span>
    selectImg<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token comment">// 选择其它封面</span>
    isSelected<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment">// 选中的图片</span>
    inputValue<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>  <span class="token comment">// 账本名字</span>
    now<span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>       <span class="token comment">// 当前时间</span>
    account<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>      <span class="token comment">// 传入账本信息</span>
<span class="token punctuation">}</span>

  <span class="token comment">// 单选逻辑 通过构造{'0': isSelected}来实现</span>
<span class="token function">selectThis</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>index
    <span class="token keyword">let</span> coverUrl <span class="token operator">=</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>coverurl
    <span class="token keyword">let</span> is <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>isSelected<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
    <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
        coverUrl
    <span class="token punctuation">}</span>
    <span class="token comment">// obj[index] 属性动态改变</span>
    obj<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">!</span>is
    obj<span class="token punctuation">.</span>i <span class="token operator">=</span> index
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        isSelected<span class="token punctuation">:</span> obj
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>表单回显逻辑</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 页面加载时先通过对应的accountKey, 得到回显信息</span>
<span class="token keyword">let</span> <span class="token punctuation">{</span> i<span class="token punctuation">,</span> id<span class="token punctuation">,</span> value<span class="token punctuation">,</span> url<span class="token punctuation">,</span> accountKey <span class="token punctuation">}</span> <span class="token operator">=</span> options
photos<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">success</span><span class="token punctuation">:</span> <span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      images<span class="token punctuation">:</span> res<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
      account<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">,</span>
        value<span class="token punctuation">,</span>
        url<span class="token punctuation">,</span>
        i<span class="token punctuation">,</span>
        accountKey
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      isSelected<span class="token punctuation">:</span> obj
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    wx<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 修改</span>
<span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>account
    <span class="token keyword">let</span> <span class="token punctuation">{</span> i<span class="token punctuation">,</span> coverUrl<span class="token punctuation">,</span> value <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>isSelected
    <span class="token comment">// 若没修改 则为之前的value</span>
    <span class="token keyword">let</span> inputValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>inputValue <span class="token operator">||</span> value
    
    db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'accounts'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">doc</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            inputValue<span class="token punctuation">,</span>
            coverUrl<span class="token punctuation">,</span>
            i
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>级联删除逻辑</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>db<span class="token punctuation">.</span><span class="token function">collection</span><span class="token punctuation">(</span><span class="token string">'accounts'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">doc</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>account<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        title<span class="token punctuation">:</span> <span class="token string">'删除成功'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        wx<span class="token punctuation">.</span><span class="token function">reLaunch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          url<span class="token punctuation">:</span> <span class="token string">'../accountBooks/accountBooks'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 调用deleteItems云函数, 传入对应accountKey主键, 通过云函数批量删除</span>
  wx<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span><span class="token function">callFunction</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'deleteItems'</span><span class="token punctuation">,</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      accountKey
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="账本页收支"><a href="#账本页收支" aria-hidden="true" class="header-anchor">#</a> 账本页收支</h2> <p><img src="https://camo.githubusercontent.com/75d424fb932f00f94c78df0f5683975d3d0419ad/68747470733a2f2f376136382d7a68682d636c6f75642d6237613161392d313235373839323938382e7463622e71636c6f75642e6c612f74726176656c626f6f6b2545362542432539342545372541342542416769662f2545382542342541362545362539432541432545362539342542362545362539342541462e6769663f7369676e3d323365613764363165643938643936363036316664666139393765303961303726743d31353432363130373537" alt=""><br>
因为收入与支出页面基本类似，所以使用自定义组件封装，可以复用。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 封装spendDetail组件</span>
<span class="token comment">// 注册组件</span>
properties<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    detail<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> Object
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    accountKey<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> Number
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    isSpend<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      type<span class="token punctuation">:</span> Boolean
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 引用组件</span>
<span class="token operator">&lt;</span>van<span class="token operator">-</span>tab title<span class="token operator">=</span><span class="token string">&quot;支出&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>spendDetail detail<span class="token operator">=</span><span class="token string">&quot;{{detail}}&quot;</span> accountKey<span class="token operator">=</span><span class="token string">&quot;{{accountKey}}&quot;</span> isSpend<span class="token operator">=</span><span class="token string">&quot;{{isSpend}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>spendDetail<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>tab<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>van<span class="token operator">-</span>tab title<span class="token operator">=</span><span class="token string">&quot;收入&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>spendDetail detail<span class="token operator">=</span><span class="token string">&quot;{{income}}&quot;</span> accountKey<span class="token operator">=</span><span class="token string">&quot;{{accountKey}}&quot;</span> isSpend<span class="token operator">=</span><span class="token string">&quot;{{isSpend}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>spendDetail<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>van<span class="token operator">-</span>tab<span class="token operator">&gt;</span>
</code></pre></div><p>收入与支出类型icon选择使用两个view来存放，通过选择不同类型，跳转不同的icon</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// js</span>
data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    address<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    money<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    desc<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    selectPicIndex<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    selectIndex<span class="token punctuation">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>
<span class="token comment">// 选择消费类别</span>
<span class="token function">selectSpend</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> <span class="token punctuation">{</span> index <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset
  <span class="token keyword">let</span> <span class="token punctuation">{</span> selectPicIndex <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data
  selectPicIndex <span class="token operator">=</span> index
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selectPicIndex
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// 选择消费类别中的细节</span>
<span class="token function">selectSpendDetail</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> <span class="token punctuation">{</span> index <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset
  <span class="token keyword">let</span> <span class="token punctuation">{</span> selectIndex <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data
  selectIndex <span class="token operator">=</span> index
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    selectIndex
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// wxml</span>
<span class="token comment">// 消费类型</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;expense&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>block wx<span class="token punctuation">:</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;{{detail}}&quot;</span> wx<span class="token punctuation">:</span>key<span class="token operator">=</span><span class="token string">&quot;index&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;expense__type&quot;</span> bindtap<span class="token operator">=</span><span class="token string">&quot;selectSpend&quot;</span> data<span class="token operator">-</span>index<span class="token operator">=</span><span class="token string">&quot;{{index}}&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>block wx<span class="token punctuation">:</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;{{selectPicIndex == item.pic_index}}&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;expense__type-icon&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;background-color: #e64343&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">&quot;{{item.pic_url_act}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>block wx<span class="token punctuation">:</span><span class="token keyword">else</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;expense__type-icon&quot;</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>image src<span class="token operator">=</span><span class="token string">&quot;{{item.pic_url}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;expense__type-name&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>type<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// 消费子类型</span>
<span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;detail&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>block wx<span class="token punctuation">:</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;{{detail[selectPicIndex].detail}}&quot;</span> wx<span class="token punctuation">:</span>key<span class="token operator">=</span><span class="token string">&quot;index&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;detail__type&quot;</span> bindtap<span class="token operator">=</span><span class="token string">&quot;selectSpendDetail&quot;</span> data<span class="token operator">-</span>index<span class="token operator">=</span><span class="token string">&quot;{{index}}&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>image <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;detail__type-icon&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;{{item.detail_url}}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>image<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>block wx<span class="token punctuation">:</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;{{selectIndex == item.detail_index}}&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;detail__type-name&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;color: #f86319; border-bottom: 1rpx solid #f86319;&quot;</span><span class="token operator">&gt;</span>
          <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>detail_type<span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>block wx<span class="token punctuation">:</span><span class="token keyword">else</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;detail__type-name&quot;</span> style<span class="token operator">=</span><span class="token string">&quot;border-bottom: 1rpx solid #e4e2e2;&quot;</span><span class="token operator">&gt;</span>
          <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>detail_type<span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
</code></pre></div><h2 id="账本页明细"><a href="#账本页明细" aria-hidden="true" class="header-anchor">#</a> 账本页明细</h2> <p><img src="https://puui.qpic.cn/vupload/0/20190618_1560844085773_tj4zundo26n.gif/0" alt=""><br>
因为收支明细中需要显示每一天的消费信息，所以需要将数据表中的数据通过时间来分类，分成若干个数组，页面从而使用wx:for来遍历这些数组。在显示之前，首先需要判断有无收支信息。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 通过时间分类算法  {} =&gt; [ [{时间1}], [{时间2}], [{时间3}] ]</span>
arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>_this<span class="token punctuation">.</span><span class="token function">isExist</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>fullDate<span class="token punctuation">,</span> dateArr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    dateArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    dateArr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fullDate <span class="token operator">==</span> item<span class="token punctuation">.</span>fullDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 使用map 方法构造 [{}, {}, {}, ...] 类型数组</span>
dateArr <span class="token operator">=</span> dateArr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> spend <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">let</span> income <span class="token operator">=</span> <span class="token number">0</span>
  item<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>money <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      spend <span class="token operator">+=</span> res<span class="token punctuation">.</span>money
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      income <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token operator">-</span>res<span class="token punctuation">.</span>money<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    item<span class="token punctuation">,</span>
    spend<span class="token punctuation">,</span>
    income
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 判断自身是否存在数组中</span>
<span class="token function">isExist</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>item <span class="token operator">==</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fullDate<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>以上是小程序中比较复杂的逻辑实现。</p> <h1 id="源码链接"><a href="#源码链接" aria-hidden="true" class="header-anchor">#</a> 源码链接</h1> <p><a href="https://github.com/FightingHao/travelbook" target="_blank" rel="noopener noreferrer">https://github.com/FightingHao/travelbook<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/TencentCloudBase/blog/edit/master/docs/案例教学/2.项目实战/更多教程文章/小程序云开发实战-旅行小账本.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">更新于: </span> <span class="time">2019-10-17 11:45:07</span></div></footer> <!----> </main></div><div class="global-ui"><div></div><div class="my-popup" style="display:none;" data-v-3414bdeb><div class="my-popup-container" data-v-3414bdeb><div class="my-popup-exit" data-v-3414bdeb></div> <img src="" alt data-v-3414bdeb></div></div><!----><!----><div></div></div></div>
    <script src="/assets/js/app.c43e3f1e.js" defer></script><script src="/assets/js/2.593b11d3.js" defer></script><script src="/assets/js/200.39293e0a.js" defer></script><script src="/assets/js/5.74e570c4.js" defer></script>
  </body>
</html>
